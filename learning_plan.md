# Eedi项目知识点学习计划

本学习计划基于项目的实际代码结构，为每个知识点提供对应的代码文件和估计学习时间。

## 学习计划总览
- **总学习时间**: 约 85-110 小时
- **学习周期**: 6-8周 (每天2-3小时)
- **难度级别**: 中高级 (需要一定的深度学习基础)

---

## 第1阶段：基础知识理解 (Week 1-2, 25-30小时)

### 1.1 机器学习基础 (8-10小时)

#### 知识点1: 监督学习框架与信息检索
- **学习时间**: 3-4小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:488-536` (数据加载和预处理)
  - `src/exp/exp010_fold_0.py:332-356` (候选生成函数)
- **学习内容**:
  - 理解检索任务的输入输出
  - 掌握双阶段检索架构设计
  - 分析训练数据的pivot操作

#### 知识点2: 评估指标 (MAP@25, Recall@K)
- **学习时间**: 2-3小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:375-412` (calculate_map25_with_metrics函数)
- **学习内容**:
  - MAP@25计算原理和实现
  - 理解排序质量评估
  - 掌握竞赛评估标准

#### 知识点3: 交叉验证策略
- **学习时间**: 2-3小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:544-548` (GroupKFold使用)
  - `src/exp/exp010_fold_0.py:533-536` (fold数据合并)
- **学习内容**:
  - GroupKFold防止数据泄露
  - 理解按QuestionId分组的重要性
  - 掌握K折交叉验证实践

#### 知识点4: 负样本采样策略
- **学习时间**: 1小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:597-603` (动态负样本采样)
- **学习内容**:
  - 对比学习中的负样本重要性
  - 动态采样vs静态采样
  - 负样本数量对模型性能的影响

### 1.2 深度学习架构基础 (10-12小时)

#### 知识点5: Transformer基础架构
- **学习时间**: 4-5小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:117-147` (Qwen2ModelLabel类)
  - `src/exp/exp010_fold_0.py:28` (Qwen2ForCausalLM导入)
- **学习内容**:
  - Qwen2架构特点
  - 因果语言模型原理
  - 注意力机制在本项目中的作用

#### 知识点6: 双编码器架构 (BiEncoder)
- **学习时间**: 3-4小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:149-227` (BiEncoderModel完整实现)
  - `src/exp/exp010_fold_0.py:203-213` (encode方法)
- **学习内容**:
  - 双编码器vs交互式模型
  - 独立编码的优势和局限
  - 相似度计算方法

#### 知识点7: 句子嵌入池化方法
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:183-201` (last_token_pool和sentence_embedding)
- **学习内容**:
  - Last Token Pooling原理
  - Mean Pooling vs Last Token的选择
  - 池化方法对模型性能的影响

### 1.3 文本处理技术 (7-8小时)

#### 知识点8: 指令微调格式设计
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:295-300` (get_detailed_instruct函数)
  - `src/exp/exp010_fold_0.py:519-532` (文本格式拼接)
- **学习内容**:
  - 指令模板设计原则
  - 多字段信息融合策略
  - 文本格式对模型理解的影响

#### 知识点9: 数据预处理管道
- **学习时间**: 3-4小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:494-532` (数据透视和特征工程)
  - `src/exp/exp015_fold_0.py` (reranker的数据处理)
- **学习内容**:
  - ABCD选项到独立样本的转换
  - 正确答案文本提取
  - 多表关联和特征构造

#### 知识点10: 合成数据生成
- **学习时间**: 2小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/gen/generate_train_72b_awq_100_example.py:46-112` (生成prompt模板)
  - `src/gen/generate_train_72b_awq_100_example.py:153-176` (vLLM推理)
- **学习内容**:
  - 基于模板的数据生成
  - Few-shot learning在数据生成中的应用
  - 生成数据的质量控制

---

## 第2阶段：核心技术深入 (Week 3-4, 25-30小时)

### 2.1 模型优化技术 (12-15小时)

#### 知识点11: LoRA参数高效微调
- **学习时间**: 4-5小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:157-173` (LoraConfig配置)
  - `src/exp/exp015_fold_0.py:72-75` (reranker的LoRA配置)
- **学习内容**:
  - LoRA数学原理和实现
  - 超参数选择策略(r, alpha, dropout)
  - 不同模块的LoRA应用效果

#### 知识点12: 量化技术 (GPTQ/AWQ)
- **学习时间**: 3-4小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:61` (GPTQ-Int4模型加载)
  - `src/gen/generate_train_72b_awq_100_example.py:156` (AWQ量化配置)
- **学习内容**:
  - 后训练量化原理
  - GPTQ vs AWQ的区别
  - 量化对模型精度的影响

#### 知识点13: 混合精度训练
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:588,634-651` (GradScaler使用)
- **学习内容**:
  - FP16/BF16混合精度原理
  - 梯度缩放机制
  - 数值稳定性考虑

#### 知识点14: 梯度检查点和累积
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:566` (gradient_checkpointing_enable)
  - `src/exp/exp010_fold_0.py:646-651` (梯度累积逻辑)
- **学习内容**:
  - 梯度检查点的内存优化原理
  - 梯度累积实现大batch训练
  - 显存使用优化策略

#### 知识点15: 优化器和学习率调度
- **学习时间**: 1小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:569-584` (优化器配置和调度器)
  - `src/exp/exp010_fold_0.py:229-271` (分组参数优化)
- **学习内容**:
  - AdamW优化器特点
  - 不同参数组的学习率设置
  - Warmup策略的作用

### 2.2 训练循环实现 (8-10小时)

#### 知识点16: 对比学习损失函数
- **学习时间**: 3-4小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:634-644` (相似度计算和损失)
  - `src/exp/exp010_fold_0.py:445-448` (compute_similarity函数)
- **学习内容**:
  - InfoNCE损失原理
  - 温度系数的作用
  - 批内负样本策略

#### 知识点17: 自定义数据集实现
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:88-114` (EediValDataset)
  - `src/exp/exp010_fold_0.py:415-442` (EediTrainDataset)
- **学习内容**:
  - PyTorch Dataset自定义
  - 动态tokenization策略
  - 数据批处理优化

#### 知识点18: 验证和推理流程
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:656-684` (验证循环)
  - `src/exp/exp010_fold_0.py:358-372` (make_emb函数)
- **学习内容**:
  - 批量embedding生成
  - KNN检索实现
  - 模型性能监控

### 2.3 高级工程技术 (5小时)

#### 知识点19: vLLM推理引擎
- **学习时间**: 3小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/gen/generate_train_72b_awq_100_example.py:153-176` (vLLM配置和推理)
- **学习内容**:
  - PagedAttention原理
  - 连续批处理机制
  - 推理参数调优

#### 知识点20: 模型保存和加载
- **学习时间**: 2小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:274-292` (save_model函数)
- **学习内容**:
  - LoRA权重提取和保存
  - 模型checkpoint管理
  - 增量权重合并

---

## 第3阶段：系统集成与实践 (Week 5-6, 20-25小时)

### 3.1 端到端系统理解 (10-12小时)

#### 知识点21: 检索阶段完整流程
- **学习时间**: 4-5小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py` (完整检索训练流程)
  - `src/exp/exp012_fold_0.py` (最终提交版本)
- **学习内容**:
  - 从数据加载到模型输出的完整流程
  - 训练和推理的区别
  - 超参数对模型性能的影响

#### 知识点22: 重排序阶段设计
- **学习时间**: 3-4小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp015_fold_0.py` (重排序模型训练)
- **学习内容**:
  - Listwise排序学习
  - 候选集筛选策略
  - 两阶段系统的配合

#### 知识点23: 实验管理和版本控制
- **学习时间**: 2-3小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:690-702` (kaggle数据集元数据)
  - 各个exp文件的组织结构
- **学习内容**:
  - 实验命名和版本管理
  - 结果输出标准化
  - 可复现性保证

### 3.2 性能优化实践 (5-7小时)

#### 知识点24: 内存和计算优化
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:326-329` (collate_sentence函数)
  - `src/exp/exp010_fold_0.py:370` (torch.cuda.empty_cache)
- **学习内容**:
  - 动态序列长度优化
  - 显存管理策略
  - 批处理效率提升

#### 知识点25: 分布式训练准备
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:215-226` (_dist_gather_tensor方法)
  - `src/gen/generate_train_72b_awq_100_example.py:155` (tensor_parallel_size)
- **学习内容**:
  - 分布式训练框架理解
  - 张量并行配置
  - 多卡协调机制

#### 知识点26: 错误处理和调试
- **学习时间**: 1小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:451-483` (日志设置)
  - `src/gen/generate_train_72b_awq_100_example.py:233-235` (异常处理)
- **学习内容**:
  - 日志系统设计
  - 常见错误排查
  - 调试技巧

### 3.3 容器化和部署 (5-6小时)

#### 知识点27: Docker环境配置
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐
- **项目代码**: 
  - `docker/Dockerfile` (训练环境)
  - `docker_vllm/Dockerfile` (推理环境)
- **学习内容**:
  - 深度学习环境容器化
  - GPU驱动和CUDA配置
  - 多阶段构建优化

#### 知识点28: 数据管道和文件系统
- **学习时间**: 2-3小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:35-41` (路径配置)
  - `results/` 目录结构
- **学习内容**:
  - 数据目录组织
  - 结果文件管理
  - 跨环境路径配置

#### 知识点29: 依赖管理和环境隔离
- **学习时间**: 1小时
- **难度**: ⭐⭐
- **项目代码**: 
  - `docker/build.sh` (构建脚本)
  - 各种import语句的依赖分析
- **学习内容**:
  - Python包管理
  - 版本兼容性
  - 环境隔离策略

---

## 第4阶段：高级应用与扩展 (Week 7-8, 15-20小时)

### 4.1 算法优化深入 (8-10小时)

#### 知识点30: 检索算法调优
- **学习时间**: 3-4小时
- **难度**: ⭐⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:351-355` (KNN检索参数)
  - 不同exp版本的参数对比
- **学习内容**:
  - 检索参数对性能的影响
  - 候选数量vs精度权衡
  - 检索速度优化

#### 知识点31: 损失函数改进
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:639` (温度系数设置)
  - 对比不同exp的损失函数设计
- **学习内容**:
  - 对比学习损失函数变种
  - 难负样本挖掘
  - 损失函数设计原则

#### 知识点32: 数据增强策略
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/gen/generate_train_72b_awq_100_example.py` (完整数据生成流程)
- **学习内容**:
  - 文本数据增强方法
  - 质量控制策略
  - 增强数据的有效性验证

### 4.2 系统扩展能力 (7-10小时)

#### 知识点33: 多模型融合策略
- **学习时间**: 3-4小时
- **难度**: ⭐⭐⭐⭐⭐
- **项目代码**: 
  - 多个fold模型的结果合并逻辑
  - `results/exp/` 多个实验结果
- **学习内容**:
  - 模型集成方法
  - 投票和加权策略
  - 多样性vs准确性权衡

#### 知识点34: 在线学习和增量更新
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐⭐⭐
- **项目代码**: 
  - LoRA权重更新机制
  - 检索索引增量更新
- **学习内容**:
  - 增量学习框架
  - 灾难性遗忘问题
  - 在线系统设计

#### 知识点35: 可解释性和分析
- **学习时间**: 2-3小时
- **难度**: ⭐⭐⭐⭐
- **项目代码**: 
  - `src/exp/exp010_fold_0.py:375-412` (详细评估指标)
  - 错误案例分析
- **学习内容**:
  - 模型预测可解释性
  - 错误案例分析方法
  - 模型行为理解

---

## 学习建议和注意事项

### 前置知识要求
- **Python编程**: 熟练使用Python和常用库
- **深度学习基础**: 理解神经网络、反向传播、损失函数
- **PyTorch框架**: 基本的模型定义、训练循环
- **NLP基础**: 了解tokenization、embedding、attention机制

### 学习方法建议

1. **理论与实践结合**
   - 每个知识点先理解理论，再分析代码实现
   - 尝试修改参数观察结果变化

2. **循序渐进**
   - 严格按照阶段顺序学习
   - 确保前一阶段掌握后再进入下一阶段

3. **动手实践**
   - 运行项目代码，观察中间结果
   - 尝试改进某个模块的实现

4. **记录笔记**
   - 记录每个知识点的理解
   - 总结代码中的技巧和坑点

### 时间分配建议
- **理论学习**: 40%
- **代码分析**: 35%
- **实践操作**: 20%
- **总结复习**: 5%

### 评估检查点
- **Week 2末**: 能够理解项目整体架构和数据流
- **Week 4末**: 能够独立训练一个检索模型
- **Week 6末**: 能够完整运行端到端系统
- **Week 8末**: 能够优化模型并分析结果

通过这个详细的学习计划，你将能够全面掌握这个高水平的NLP竞赛解决方案中的所有核心技术。